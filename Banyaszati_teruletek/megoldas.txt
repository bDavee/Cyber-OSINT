1, Feladat 

CREATE DATABASE mbt;

CREATE TABLE telek (
    id int NOT NULL AUTO_INCREMENT,
    telepules varchar(200),
    muvmod varchar(200),
    allapot varchar(1),
    fedoszint decimal(6,2),
    fekuszint decimal(6,2),
    PRIMARY KEY (id)  
);

CREATE TABLE kapcsolo(
    telekid int NOT NULL,
    nyersanyagid int NOT NULL,
    PRIMARY KEY (telekid, nyersanyagid),
    FOREIGN KEY (telekid) REFERENCES telek(id),
    FOREIGN KEY (nyersanyagid) REFERENCES nyersanyag(id)
);

CREATE TABLE nyersanyag (
   id int NOT NULL,
   nev varchar(250),
   PRIMARY KEY (id)

);

2, Feladat

SELECT telepules,muvmod FROM `telek` WHERE allapot="S" ORDER BY muvmod, telepules;

3, Feladat

SELECT DISTINCT n.nev FROM telek t JOIN kapcsolo k ON t.id = k.telekid JOIN nyersanyag n ON k.nyersanyagid = n.id WHERE t.fedoszint < 0 AND t.fekuszint < 0;

4, Feladat

SELECT t.telepules, t.fedoszint, t.fekuszint FROM telek t JOIN kapcsolo k ON t.id = k.telekid JOIN nyersanyag n ON k.nyersanyagid = n.id WHERE t.allapot = 'M'AND n.nev LIKE '%dolomit%';

5, Feladat

SELECT t.telepules, (t.fedoszint - t.fekuszint) AS vastagsag,n.nev FROM telek t JOIN kapcsolo k ON t.id = k.telekid JOIN nyersanyag n ON k.nyersanyagid = n.id WHERE n.nev LIKE '%kavics%' ORDER BY vastagsag DESC LIMIT 3;

6, Feladat
SELECT DISTINCT t.telepules, n.nev FROM telek t JOIN kapcsolo k ON t.id = k.telekid JOIN nyersanyag n ON k.nyersanyagid = n.id WHERE t.fedoszint >= 450 AND t.fekuszint <= 550;

7, Feladat

SELECT n.nev, COUNT(*) AS telek_szam FROM kapcsolo k JOIN nyersanyag n ON k.nyersanyagid = n.id GROUP BY n.nev ORDER BY telek_szam DESC LIMIT 1;